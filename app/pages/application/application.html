<ion-view view-title="应用" class="new-application">

  <!--<ion-header-bar align-title="center" class="bar-stable">-->
    <!--<h1 class="title">应用</h1>-->
    <!--&lt;!&ndash;<div class="buttons">-->
      <!--<button class="button button-clear" style="font-size: 26px" ng-click="openSetting()">-->
        <!--<i class="ion-ios-gear-outline"></i>-->
      <!--</button>-->
    <!--</div>&ndash;&gt;-->
    <!--<div class="buttons">-->
      <!--<button class="button button-clear" style="font-size: 16px" ng-click="freshMenuList()">-->
        <!--刷新-->
      <!--</button>-->
    <!--</div>-->

  <!--</ion-header-bar>-->

  <div class="application-header" ng-style="headerStyle" ng-if="showHeader">
    应用
  </div>

  <img ng-src="{{titleBg}}" class="top-bg" ng-style="bgStyle"/>
  <div class="crm-search" ng-click="goSearch()" ng-if="hasCrm" ng-style="searchStyle"><img src="build/img/application/search@3x.png"/>搜索客户、商机、线索</div>

  <ion-content class="mainApplication" style="bottom:48px;" scrollbar-y="false" on-drag="onDragContent()" on-swipe="onSwipeContent()" on-release="onReleaseContent()">
    <div on-release="onRelease()" class="application-setting-outer"
         ng-show="animationsEnabled">
    </div>
    <div class="application-setting" ng-if="animationsEnabled">
      <div class="setup">
        <ion-item class="setup-panel">
          <div class="row setup-panel-row1">
            <label class="setup-label">Timesheet滑动填写</label>
          </div>
          <div class="ts-toggle-position">
            <label class="toggle toggle-positive">
              <input type="checkbox" ng-checked="slippingEnableFlag" ng-click="changeSlippingSetting()">

              <div class="track setup-track">
                <div class="handle setup-handle"></div>
              </div>
            </label>
          </div>
        </ion-item>
      </div>
    </div>

    <div class="calendar-container">
      <img ng-src="{{titleBg}}" class="calendar-head"/>
      <div class="calendar-content">
        <div class="application-calendar">
          <img ng-src="{{titleBg}}" class="blur-bg"/>
          <div class="white-bg"></div>
          <div ng-repeat="weekday in weekdays track by $index" class="highlight head-item">{{weekday}}</div>
          <div ng-repeat="day in days track by $index" class="date-item" ng-class="{true:'selected'}[nowSelectedDate == $index]" ng-click="selectDate($index)">
            {{getDateText(day)}}
            <div class="dot-container">
              <span class="TS-state" ng-class="{0:'TS-refuse',1:'TS-commit',2:'TS-approval'}[day.timeSheetValue]"></span>
              <span class="plan-state" ng-class="{true:'plan-has'}[day.planCount != 0]" ng-if="hasCrm"></span>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="message-area">
      <div class="message-area-item" ng-click="goWrite(days[nowSelectedDate])" ng-class="{0:'TS-refuse-message',1:'TS-commit-message',2:'TS-approval-message'}[days[nowSelectedDate].timeSheetValue]">{{days[nowSelectedDate].timeSheetText}}TS{{days[nowSelectedDate].project == "" ? "" : "： " + days[nowSelectedDate].project}}</div>
      <div class="slim-line" ng-if="hasCrm"></div>
      <div class="message-area-item" ng-if="hasCrm" ng-click="goPlan()" ng-class="{true:'plan-has-message'}[days[nowSelectedDate].planCount != 0]">销售计划： {{days[nowSelectedDate].planCount}}条 </div>
    </div>

    <div class="application-outer">
      <div class="hms-animated application-left" ng-class="{true: 'start', false: ''}[animationsEnabled]">
        <div class="appRegion firstLine" ng-if="hasCrm">
          <div class="appAreaBorder">
            <div class="appTitle office"><img src="build/img/application/line@3x.png"/>CRM</div>
          </div>
          <div class="appArea" ng-repeat="appList in crmApp">
            <div class="appList" ng-repeat="appItem in appList.list" ng-if="$index==0||$index==1"
                 ng-click="goPage(appItem)">
              <div class="appItem">
                <div class="app-item-content">
                  <div class="app-extra" ng-if="appItem.hasWorkflowNum&&!fetchWorkflowData&&appItem.count!=0"
                       ng-bind="appItem.count">
                  </div>
                  <div ng-if="appItem.hasWorkflowNum&&fetchWorkflowData" class="app-extra-refresh">
                    <ion-spinner icon="ios" class="spinner spinner-ios"></ion-spinner>
                  </div>
                  <img ng-src="{{appItem.imageUrl}}" ng-if="appItem.imageUrl!=''"/>
                </div>
              </div>
              <div class="appText">{{appItem.appName}}</div>
            </div>
          </div>
        </div>
        <div class="appRegion">
          <div class="appTitle office"><img src="build/img/application/line@3x.png"/>个人办公</div>
          <div class="appArea" ng-repeat="appList in officeApp">
            <div class="appList" ng-repeat="appItem in appList.list" ng-if="$index==0||$index==1" ng-click="goPage(appItem)">
              <div class="appItem">
                <div class="app-item-content">
                  <div class="app-extra" ng-if="appItem.hasWorkflowNum&&!fetchWorkflowData&&appItem.count!=0"
                       ng-bind="appItem.count">
                  </div>
                  <div ng-if="appItem.hasWorkflowNum&&fetchWorkflowData" class="app-extra-refresh">
                    <ion-spinner icon="ios" class="spinner spinner-ios"></ion-spinner>
                  </div>
                  <img ng-src="{{appItem.imageUrl}}" ng-if="appItem.imageUrl!=''"/>
                </div>
              </div>
              <div class="appText">{{appItem.appName}}</div>
            </div>
          </div>
        </div>

        <div class="appRegion">
          <div class="appTitle project"><img src="build/img/application/line@3x.png"/>项目门户</div>
          <div class="appArea" ng-repeat="appList in projectApp">
            <div class="appList" ng-repeat="appItem in appList.list" ng-if="$index==0||$index==1" ng-click="goPage(appItem)">
              <div class="appItem">
                <div class="app-item-content">
                  <img ng-src="{{appItem.imageUrl}}" ng-if="appItem.imageUrl!=''"/>
                </div>
              </div>
              <div class="appText">{{appItem.appName}}</div>
            </div>
          </div>
        </div>

        <div class="appRegion">
          <div class="appTitle employee"><img src="build/img/application/line@3x.png"/>员工社区</div>
          <div class="appArea" ng-repeat="appList in employeeApp">
            <div class="appList" ng-repeat="appItem in appList.list" ng-if="$index==0||$index==1" ng-click="goPage(appItem)">
              <div class="appItem">
                <div class="app-item-content">
                  <img ng-src="{{appItem.imageUrl}}" ng-if="appItem.imageUrl!=''"/>
                </div>
              </div>
              <div class="appText">{{appItem.appName}}</div>
            </div>
          </div>
        </div>
      </div>
      <div class="hms-animated application-right" ng-class="{true: 'start', false: ''}[animationsEnabled]">
        <div class="appRegion firstLine" ng-if="hasCrm">
          <div class="appTitle"></div>
          <div class="appArea" ng-repeat="appList in crmApp">
            <div class="appList" ng-repeat="appItem in appList.list" ng-if="$index==2||$index==3" ng-click="goPage(appItem)">
              <div class="appItem" >
                <div class="app-item-content">
                  <img ng-src="{{appItem.imageUrl}}" ng-if="appItem.imageUrl!=''"/>
                </div>
              </div>
              <div class="appText">{{appItem.appName}}</div>
            </div>
          </div>
        </div>
        <div class="appRegion">
          <div class="appTitle"></div>
          <div class="appArea" ng-repeat="appList in officeApp">
            <div class="appList" ng-repeat="appItem in appList.list" ng-if="$index==2||$index==3" ng-click="goPage(appItem)">
              <div class="appItem">
                <div class="app-item-content">
                  <div class="app-extra" ng-if="appItem.hasWorkflowNum&&!fetchWorkflowData&&appItem.count!=0"
                       ng-bind="appItem.count">
                  </div>
                  <div ng-if="appItem.hasWorkflowNum&&fetchWorkflowData" class="app-extra-refresh">
                    <ion-spinner icon="ios" class="spinner spinner-ios"></ion-spinner>
                  </div>
                  <img ng-src="{{appItem.imageUrl}}" ng-if="appItem.imageUrl!=''"/>
                </div>
              </div>
              <div class="appText">{{appItem.appName}}</div>
            </div>
          </div>
        </div>

        <div class="appRegion">
          <div class="appTitle"></div>
          <div class="appArea" ng-repeat="appList in projectApp">
            <div class="appList" ng-repeat="appItem in appList.list" ng-if="$index==2||$index==3" ng-click="goPage(appItem)">
              <div class="appItem" >
                <div class="app-item-content">
                  <img ng-src="{{appItem.imageUrl}}" ng-if="appItem.imageUrl!=''"/>
                </div>
              </div>
              <div class="appText">{{appItem.appName}}</div>
            </div>
          </div>
        </div>

        <div class="appRegion">
          <div class="appTitle"></div>
          <div class="appArea" ng-repeat="appList in employeeApp">
            <div class="appList" ng-repeat="appItem in appList.list" ng-if="$index==2||$index==3" ng-click="goPage(appItem)">
              <div class="appItem">
                <div class="app-item-content">
                  <img ng-src="{{appItem.imageUrl}}" ng-if="appItem.imageUrl!=''"/>
                </div>
              </div>
              <div class="appText">{{appItem.appName}}</div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </ion-content>
</ion-view>
