function jsonFormat(e){var t=angular.toJson(e,!0);return t}function getCurrentDate(e){var t=e.getFullYear(),o=e.getMonth()+1,a=e.getDate();o=10>o?"0"+o:o,a=10>a?"0"+a:a;var n=t.toString()+"-"+o.toString()+"-"+a.toString();return n}function getLastMonthDate(e){var t=e.getFullYear(),o=e.getMonth(),a=new Date(t,o,1),n=new Date(a.getTime()-864e5).getDate();o=10>o?"0"+o:o,n=10>n?"0"+n:n;var r=t.toString()+"-"+o.toString()+"-"+n.toString();return r}function getCurrentMonthLastDate(e){var t=e.getFullYear(),o=e.getMonth()+1,a=new Date(t,o,1),n=new Date(a.getTime()-864e5).getDate();o=10>o?"0"+o:o,n=10>n?"0"+n:n;var r=t.toString()+"-"+o.toString()+"-"+n.toString();return r}function getMonthDay(e){var t=e.substring(5,7)+"月"+e.substring(8,10)+"日";return t}function unique_normal(e){for(var t=[],o=0;o<e.length;o++){var a=e[o];-1===t.indexOf(a)&&t.push(a)}return t}function unique(e){for(var t=[],o=0;o<e.length;o++){var a=e[o];-1===indexOf(t,a)&&t.push(a)}return t}function unique_better(e,t){for(var o=[],a={},n=0;n<e.length;n++){if("object"==typeof e[n])var r=e[n][t];else var r=e[n];var s=e[n],l=typeof r+r;1!==a[l]&&(o.push(s),a[l]=1)}return o}angular.module("baseConfig",[]).constant("baseConfig",{debug:!0,isMobilePlatform:!1,clearTable:!0,nativeScreenFlag:!1,basePath:"http://wechat.hand-china.com/hmbms_hand/api",businessPath:"http://wechat.hand-china.com/hmbms_hand/api/dataEngine",currentVersion:"2.0.0",url:"",pkgIdentifier:"",versionName:"此版本为dev测试环境 2.0.0",appEnvironment:"UAT"});var utilModule=angular.module("utilModule",[]),HmsModule=angular.module("HmsModule",[]),loginModule=angular.module("loginModule",[]),messageModule=angular.module("messageModule",[]),contactModule=angular.module("contactModule",[]),applicationModule=angular.module("applicationModule",[]),myInfoModule=angular.module("myInfoModule",[]),tsApproveModule=angular.module("tsApproveModule",[]);HmsModule.directive("hideTabs",function(e){return{restrict:"A",link:function(t,o,a){t.$on("$ionicView.beforeEnter",function(){t.$watch(a.hideTabs,function(t){console.log("$ionicView.beforeEnter value "+t),t?e.hideTabs=!1:e.hideTabs=!0})}),t.$on("$ionicView.beforeLeave",function(){e.hideTabs=!0,console.log("$ionicView.beforeLeave value ")})}}}).directive("elasticImage",function(e){return{restrict:"A",link:function(e,t,o){var a=document.getElementById(o.elasticImage),n=a.offsetHeight;t.bind("scroll",function(e){var t=e.detail.scrollTop,o=n-t;0>o&&(o=0),a.style.height=o+"px"})}}}).directive("circleRotate",function(e){return{restrict:"A",link:function(t,o,a){var n=a.circleRotate,r=n.split(",");if(console.log(r),"dorm-apply"==r[0]){var s=document.getElementById(r[1]),l=document.getElementById(r[2]),i=t.leftDays/t.totalDays;.5>=i?(s.style.transition="all 0.3s linear",s.style.webkitTransition="all 0.3s linear",l.style.transition="all 0.3s ease-out",l.style.webkitTransition="all 0.3s ease-out"):i>.5&&(s.style.transition="all 0.3s ease-out 0.3s",s.style.webkitTransition="all 0.3s ease-out 0.3s",l.style.transition="all 0.3s ease-in",l.style.webkitTransition="all 0.3s ease-in"),s.style.webkitTransform="rotate(-135deg)",s.style.transform="rotate(-135deg)",l.style.webkitTransform="rotate(-135deg)",l.style.transform="rotate(-135deg)",e(function(){var e=0;.5>=i?(e=360*i,e-=135,s.style.webkitTransform="rotate(-135deg)",s.style.transform="rotate(-135deg)",l.style.webkitTransform="rotate("+e+"deg)",l.style.transform="rotate("+e+"deg)"):i>.5&&(i-=.5,e=360*i,e-=135,s.style.webkitTransform="rotate("+e+"deg)",s.style.transform="rotate("+e+"deg)",l.style.webkitTransform="rotate(45deg)",l.style.transform="rotate(45deg)")},500)}else if("time-off-manage"==r[0]){var c=document.getElementById(r[1]),p=document.getElementById(r[2]),u=document.getElementById(r[3]),d=document.getElementById(r[4]),g=document.getElementById(r[5]),m=document.getElementById(r[6]),f=t.paidHolidayLeftDays/t.paidHolidayTotalDays,h=t.paidSickLeftDays/t.paidSickTotalDays,y=t.extPaidHolidayLeftDays/t.extPaidHolidayTotalDays;.5>=f?(c.style.transition="all 0.3s linear",c.style.webkitTransition="all 0.3s linear",p.style.transition="all 0.3s ease-out",p.style.webkitTransition="all 0.3s ease-out"):f>.5&&(c.style.transition="all 0.3s ease-out 0.3s",c.style.webkitTransition="all 0.3s ease-out 0.3s",p.style.transition="all 0.3s ease-in",p.style.webkitTransition="all 0.3s ease-in"),.5>=h?(u.style.transition="all 0.3s linear",u.style.webkitTransition="all 0.3s linear",d.style.transition="all 0.3s ease-out",d.style.webkitTransition="all 0.3s ease-out"):h>.5&&(u.style.transition="all 0.3s ease-out 0.3s",u.style.webkitTransition="all 0.3s ease-out 0.3s",d.style.transition="all 0.3s ease-in",d.style.webkitTransition="all 0.3s ease-in"),.5>=y?(g.style.transition="all 0.3s linear",g.style.webkitTransition="all 0.3s linear",m.style.transition="all 0.3s ease-out",m.style.webkitTransition="all 0.3s ease-out"):y>.5&&(g.style.transition="all 0.3s ease-out 0.3s",g.style.webkitTransition="all 0.3s ease-out 0.3s",m.style.transition="all 0.3s ease-in",m.style.webkitTransition="all 0.3s ease-in"),c.style.webkitTransform="rotate(-135deg)",c.style.transform="rotate(-135deg)",p.style.webkitTransform="rotate(-135deg)",p.style.transform="rotate(-135deg)",u.style.webkitTransform="rotate(-135deg)",u.style.transform="rotate(-135deg)",d.style.webkitTransform="rotate(-135deg)",d.style.transform="rotate(-135deg)",g.style.webkitTransform="rotate(-135deg)",g.style.transform="rotate(-135deg)",m.style.webkitTransform="rotate(-135deg)",m.style.transform="rotate(-135deg)",e(function(){var e=0,t=0,o=0;.5>=f?(e=360*f,e-=135,c.style.webkitTransform="rotate(-135deg)",c.style.transform="rotate(-135deg)",p.style.webkitTransform="rotate("+e+"deg)",p.style.transform="rotate("+e+"deg)"):f>.5&&(f-=.5,e=360*f,e-=135,c.style.webkitTransform="rotate("+e+"deg)",c.style.transform="rotate("+e+"deg)",p.style.webkitTransform="rotate(45deg)",p.style.transform="rotate(45deg)"),.5>=h?(t=360*h,t-=135,u.style.webkitTransform="rotate(-135deg)",u.style.transform="rotate(-135deg)",d.style.webkitTransform="rotate("+t+"deg)",d.style.transform="rotate("+t+"deg)"):h>.5&&(h-=.5,t=360*h,t-=135,u.style.webkitTransform="rotate("+t+"deg)",u.style.transform="rotate("+t+"deg)",d.style.webkitTransform="rotate(45deg)",d.style.transform="rotate(45deg)"),.5>=y?(o=360*y,o-=135,g.style.webkitTransform="rotate(-135deg)",g.style.transform="rotate(-135deg)",m.style.webkitTransform="rotate("+o+"deg)",m.style.transform="rotate("+o+"deg)"):y>.5&&(y-=.5,o=360*y,o-=135,g.style.webkitTransform="rotate("+o+"deg)",g.style.transform="rotate("+o+"deg)",m.style.webkitTransform="rotate(45deg)",m.style.transform="rotate(45deg)")},500)}}}}),HmsModule.directive("hmsLoading",function(e){return{restrict:"E",template:'<div class="hms-hide-content"><div class="content">数据加载中...</div><div class="hide-icon"><ion-spinner icon="ios" class="spinner spinner-ios"></ion-spinner></div></div>',replace:!0,transclude:!1,controller:["$scope",function(e){}],link:function(e,t,o,a){}}}),HmsModule.directive("footerSelect",function(){return{restrict:"E",scope:{selectAllItem:"&",passThrough:"&",refuse:"&"},template:'<ion-footer-bar class="foot-bar"><div class="row buttons"><button class="button button-clear ts-button-left" ng-click="selectAllItem()">全选</button><button class="button button-clear ts-button-center" ng-click="passThrough()">通过</button><button class="button button-clear ts-button-right" ng-click="refuse()">拒绝</button></div></ion-footer-bar>',replace:!0,transclude:!1,controller:["$scope",function(e){}],link:function(e,t,o,a){}}}),HmsModule.directive("customHeadBar",function(){return{restrict:"E",scope:{actionName:"@",customTitle:"@",goBackPage:"&",doAction:"&"},template:'<div class="custom-head custom-head-background"><div class="row custom-first-head"><button class="button button-clear back-button" ng-click="goBackPage()"><i class="ion-ios-arrow-back"></i><span class="back-text">返回</span></button><button class="button button-clear action-button" ng-click="doAction()" ng-bind="actionName"></button></div><div class="ts-list-title" ng-bind="customTitle"></div><div class="custom-second-head" ng-transclude></div></div>',replace:!0,transclude:!0,controller:["$scope",function(e){}],link:function(e,t,o,a){}}}),HmsModule.directive("hmsWorkflowList",function(){return{restrict:"EA",replace:!0,transclude:!0,scope:{title:"=workflowTitle",icon:"=workflowIcon",type:"=workflowType",typeValue:"=workflowTypeValue",node:"=workflowNode",nodeValue:"=workflowNodeValue",submit:"=workflowSubmit",submitPerson:"=workflowSubmitPerson"},template:'<a class="workflow-list"><div class="workflow-list-logo"><img src="{{icon}}"/></div><div class="workflow-list-header">{{title}}</div><div class="workflow-list-content"><div class="row no-padding"><div class="col col-90 no-padding"><div class="row no-padding"> <div class="col col-33 no-padding color-type">{{type}}</div><div class="col col-67 no-padding color-content">{{typeValue}}</div></div><div class="row no-padding"><div class="col col-33 no-padding color-type">{{node}}</div><div class="col col-67 no-padding color-content">{{nodeValue}}</div></div><div class="row no-padding"><div class="col col-33 no-padding color-type">{{submit}}</div><div class="col col-67 no-padding color-content">{{submitPerson}}</div></div></div><div class="col col-10 no-padding col-center workflow-list-select"><img src="build/img/workflow/select@3x.png"/></div></div></div></a>',controller:["$scope",function(e){}],link:function(e,t,o){}}}),angular.module("HmsModule").directive("hmsslidecalendar",["$animate","$timeout","$compile","$ionicHistory","$ionicScrollDelegate",function(e,t,o,a,n){return{restrict:"E",replace:!0,transclude:!0,scope:{autoPlay:"=",doesContinue:"@",slideInterval:"@",showPager:"@",pagerClick:"&",disableScroll:"@",onSlideChanged:"&",activeSlide:"=?",bounce:"@"},controller:["$scope","$element","$attrs",function(e,o,a){function n(e){return"undefined"!=typeof e}console.log("$element[0] "+angular.toJson(o[0]));var r=e.$eval(e.doesContinue)===!0,s=e.$eval(e.bounce)!==!1,l=n(a.autoPlay)?!!e.autoPlay:!1,i=l?e.$eval(e.slideInterval)||4e3:0;console.log("continuous "+r),console.log("bouncing "+s),console.log("shouldAutoPlay "+l),console.log("slideInterval "+i);var c=new ionic.views.calendar({el:o[0],auto:i,continuous:r,startSlide:e.activeSlide,bouncing:s,slidesChanged:function(){e.currentSlide=c.currentIndex(),t(function(){})},callback:function(o){e.currentSlide=o,e.onSlideChanged({index:e.currentSlide,$index:e.currentSlide}),e.$parent.$broadcast("slideBox.slideChanged",o),e.activeSlide=o,t(function(){})},onDrag:function(){console.log("slider.onDrag "),freezeAllScrolls(!0)},onDragEnd:function(){console.log("slider.onDragEnd "),freezeAllScrolls(!1)}});e.$watch("activeSlide",function(e){console.log("slider.scope.activeSlide "),n(e)&&c.slide(e)}),e.$on("slideBox.nextSlide",function(){console.log("slider.slideBox.nextSlide "),c.next()}),e.$on("slideBox.prevSlide",function(){console.log("slider.slideBox.prevSlide "),c.prev()}),e.$on("slideBox.setSlide",function(e,t){console.log("slider.slideBox.setSlide "),c.slide(t)}),this.__slider=c,e.$on("$destroy",function(){console.log("$destroy ")}),t(function(){})}],template:'<div class="slider"><div class="slider-slides" ng-transclude></div></div>',link:function(t,o,a){e.enabled(o,!1)}}}]),angular.module("utilModule").factory("httpRequestHeader",function(){var e={request:function(e){if(window.localStorage.token&&window.localStorage.empno){var t=(new Date).getTime(),o=CryptoJS.MD5(window.localStorage.token+t);e.headers.timestamp=t,e.headers.token=o,e.headers.loginName=window.localStorage.empno}return e}};return e}),HmsModule.filter("weekDay",function(){return function(e){if(""==e)return e;var t=new Date(e),o=t.getDay();switch(o){case 0:e+="　星期天";break;case 1:e+="　星期一";break;case 2:e+="　星期二";break;case 3:e+="　星期三";break;case 4:e+="　星期四";break;case 5:e+="　星期五";break;case 6:e+="　星期六"}return e}});var log=console.log.bind(console),warn=console.warn.bind(console),error=console.error.bind(console),indexOf=[].indexOf?function(e,t){return e.indexOf(t)}:function(e,t){for(var o=0;o<e.length;o++)if(e[o]===t)return o;return-1};angular.module("HmsModule").factory("hmsHttp",["$log","$http","hmsPopup",function(e,t,o){var a="HmsHttp",n="isSucessfull",r=a+".noAuthorPost",s=a+".post",l=a+".get",i=function(e){Prompter.hideLoading(),e.go("login")},c={goBackLogin:function(e){i(e)},isSuccessfull:function(t){return e.debug(n+" Start!"),e.debug(r+" status "+t),"S"==t||"SW"==t},post:function(o,a){e.debug(s+" Start!"),e.debug(s+" url "+o),e.debug(s+" paramter "+angular.toJson(a));var n=t.post(o,a).success(function(t){e.debug(s+" success"),e.debug(s+" End!")}).error(function(t,o){e.debug(s+" error"),e.debug(s+" response "+t),e.debug(s+" status "+o),e.debug(s+" End!")});return n},get:function(o){e.debug(l+" Start!"),e.debug(l+" url "+o);var a=t.get(o).success(function(t){e.debug(l+" success"),e.debug(l+" response "+angular.toJson(t)),e.debug(l+" End!")}).error(function(t,o){e.debug(l+" error"),e.debug(l+" response "+t),e.debug(l+" status "+o),e.debug(l+" End!")});return a}};return c}]).service("hmsPopup",["$ionicLoading","$cordovaToast","$ionicPopup","baseConfig",function(e,t,o,a){this.showLoading=function(t){e.show({template:'<ion-spinner icon="ios" class="spinner spinner-ios spinner-stable"></ion-spinner><div style="color: white;font-size: 12px;text-align: center;height:25px;line-height: 25px;">'+t+"</div>"})},this.hideLoading=function(){e.hide()},this.showShortCenterToast=function(o){a.nativeScreenFlag?t.showLongBottom(angular.isDefined(o)?o:"操作失败").then(function(e){},function(e){}):e.show({template:angular.isDefined(o)?o:"操作失败",animation:"fade-in",showBackdrop:!1,maxWidth:200,duration:2e3})},this.showPopup=function(e,t){if(a.nativeScreenFlag){var n=function(){};navigator.notification.alert(e,n,"提示","确定")}else o.show({title:"提示",template:e,buttons:[{text:"确定",type:"button button-cux-popup-confirm"}]})},this.prompt=function(e,t,n,r){if(a.nativeScreenFlag)navigator.notification.prompt(t,r,"填写信息",["确定","退出"],"");else{var s=o.show({template:'<input type="type" ng-model="myScope.data.city">',title:t,subTitle:t,scope:e,buttons:[{text:"取消"},{text:"<b>确定</b>",type:"button-positive",onTap:function(t){return e.myScope.data.city?e.myScope.data.city:void t.preventDefault()}}]});s.then(n)}},this.confirm=function(e,t,n){if(a.nativeScreenFlag)navigator.notification.confirm(e,n,t,["确定","取消"]);else{var r=o.confirm({title:angular.isDefined(t)?t:"提示",template:e,cancelText:"取消",cancelType:"button-cux-popup-cancel",okText:"确定",okType:"button-cux-popup-confirm"});r.then(n)}}}]).factory("hmsReturnView",["$ionicHistory","baseConfig",function(e,t){var o=(window.screen.width-50,{width:""});return{go:function(t){var o=e.currentHistoryId(),a=e.viewHistory().histories[o],n=a.stack.length-1-t;e.backView(a.stack[n]),e.goBack()},returnToState:function(o){var a=e.currentHistoryId(),n=e.viewHistory().histories[a];t.debug&&console.log("history.stack.length : "+n.stack.length);for(var r=n.stack.length-1;r>=0;r--)t.debug&&console.log("history.stack[i].stateName : "+n.stack[r].stateName),n.stack[r].stateName==o&&(e.backView(n.stack[r]),e.goBack())},getStackList:function(e,o){var a=[],n=e.currentHistoryId(),r=e.viewHistory().histories[n];t.debug&&console.log(e.viewHistory());for(var s="#F99D32",l=0;l<r.stack.length;l++){l==r.stack.length-1&&(s="black");var i={viewId:r.stack[l].viewId,stateName:r.stack[l].stateName,title:r.stack[l].title,color:{color:s}};t.debug&&console.log(r.stack[l]),a.push(i)}return a[a.length-1].title=o,a},getWidth:function(){return o}}}]).factory("hmsBackLine",["$ionicHistory","baseConfig",function(e){var t,o=window.screen.width-50,a={width:""},n=0,r=[];return{getViews:function(e){t=e.toString().length,ROOTCONFIG.debug&&console.log(t);for(var s=0;s<r.length;s++)if(e==r[s].name){r=r.slice(0,s+1),n=0;for(var l=0;l<r.length;l++)n=l==r.length-1?n+14*r[l].name.toString().length+8:n+14*r[l].name.toString().length+18+8;console.log(n),o>n?a.width="":a.width=n+"px";for(var i=0;i<r.length-1;i++)r[i].myStyle.color="#F99D32";return console.log(r),r[r.length-1].myStyle.color="black",r}var c={name:e,myStyle:{color:""}};r.push(c),n=0;for(var p=0;s<r.length;p++)n=p==r.length-1?n+14*r[p].name.toString().length+8:n+14*r[p].name.toString().length+18+8;n>o&&(a.width=n+"px");for(var u=0;u<r.length-1;s++)r[u].myStyle.color="#F99D32";return r},getWidth:function(){return a}}}]).factory("$hmsHelp",["$ionicTemplateLoader","$ionicBackdrop","$q","$timeout","$rootScope","$ionicBody","$compile","$ionicPlatform","$ionicModal","IONIC_BACK_PRIORITY",function(e,t,o,a,n,r,s,l,i,c){function p(e,t){t?e.$$hashKey=t:delete e.$$hashKey}function u(e,t){var o=e.$$hashKey;baseConfig.debug&&console.log(arguments);for(var a=1,n=arguments.length;n>a;a++){var r=arguments[a];if(r)for(var s=Object.keys(r),l=0,i=s.length;i>l;l++){var c=s[l];e[c]=r[c]}}return p(e,o),e}function d(){var e={};return e.scope=n.$new(),e.element=angular.element(h),e.responseDeferred=o.defer(),r.get().appendChild(e.element[0]),baseConfig.debug&&debug(e.element),s(e.element)(e.scope),u(e.scope,{title:"",$buttonTapped:function(){baseConfig.debug&&debug("$buttonTapped"),e.responseDeferred.resolve(1)}}),e.show=function(){e.isShown||e.removed||(i.stack.add(e),e.isShown=!0,ionic.requestAnimationFrame(function(){e.isShown&&f(e.element)}))},e.hide=function(t){return baseConfig.debug&&console.log("4 self.hide "+t),t=t||function(){},e.isShown?(i.stack.remove(e),e.isShown=!1,void a(t,250,!1)):t()},e.remove=function(){baseConfig.debug&&console.log("5 self.remove "),!e.removed&&i.stack.isHighest(e)&&(e.hide(function(){e.element.remove(),e.scope.$destroy()}),e.removed=!0)},e}function g(){var e=b[b.length-1];e&&e.responseDeferred.resolve()}function m(){function e(){b.push(t),baseConfig.debug&&console.log("popupStack.push(popup)"),a(t.show,o,!1),t.responseDeferred.promise.then(function(e){var o=b.indexOf(t);return-1!==o&&b.splice(o,1),baseConfig.debug&&console.log("popupStack.length"),b.length>0?b[b.length-1].show():(a(function(){!b.length},400,!1),(w._backButtonActionDone||function(){})()),t.remove(),e})}var t=$HmsHelp._createPopup(),o=0;return b.length>0?(b[b.length-1].hide(),o=y.stackPushDelay):w._backButtonActionDone=l.registerBackButtonAction(g,c.popup),t.responseDeferred.promise.close=function(e){t.removed||t.responseDeferred.resolve(e)},t.responseDeferred.notify({close:t.responseDeferred.close}),e(),t.responseDeferred.promise}function f(e){var t=e[0].querySelector("[autofocus]");t&&t.focus()}var h,y={stackPushDelay:75};h=ionic.Platform.isIOS()?'<div style="position: absolute;top:2px;left: -4px;bottom: 0;right: 0;background: url(img/mainHide.png); background-size: cover;;z-index: 12;"><div style="height: 100%;width: 100%;background: none" ng-click="$buttonTapped()"></div></div>':'<div style="position: absolute;top: -14px;left: -4px;bottom: 0;right: 0;background: url(img/mainHide.png); background-size: cover;;z-index: 12;"><div style="height: 100%;width: 100%;background: none" ng-click="$buttonTapped()"></div></div>';var b=[],w={showPopup:m,_createPopup:d,_popupStack:b};return w}]).factory("hmsFastPath",function(){var e={configFastPath:function(e,t,o){e.screenWidth={width:window.screen.width-50+"px"},e.scrollWidth=t.getWidth();var a=document.getElementsByTagName("ion-view"),n=a[a.length-1].attributes[0].value;e.currentStackList=t.getStackList(o,n),e.goStack=function(e){t.returnToState(e.stateName)}}};return e}),angular.module("myApp",["ionic","ngCordova","loginModule","baseConfig","messageModule","contactModule","applicationModule","myInfoModule","utilModule","tsApproveModule","HmsModule"]),angular.module("myApp").run(function(e){e.ready(function(){window.cordova&&window.cordova.plugins&&window.cordova.plugins.Keyboard&&(cordova.plugins.Keyboard.hideKeyboardAccessoryBar(!1),cordova.plugins.Keyboard.disableScroll(!0)),window.StatusBar&&StatusBar.styleDefault()})}),angular.module("myApp").config(["$stateProvider","$urlRouterProvider","$httpProvider","$ionicConfigProvider",function(e,t,o,a){o.interceptors.push("httpRequestHeader"),a.platform.ios.tabs.style("standard"),a.platform.ios.tabs.position("bottom"),a.platform.android.tabs.style("standard"),a.platform.android.tabs.position("standard"),a.platform.ios.navBar.alignTitle("center"),a.platform.android.navBar.alignTitle("center"),a.platform.android.backButton.previousTitleText("").icon("ion-android-arrow-back"),a.platform.ios.views.transition("ios"),a.platform.android.views.transition("android"),e.state("tab",{url:"/tab","abstract":!0,templateUrl:"build/pages/tab/tabs.html",controller:"TabsCtrl"}).state("tab.message",{url:"/message",views:{"tab-message":{templateUrl:"build/pages/message/message.html",controller:"messageCtrl"}}}).state("tab.messageDetail",{url:"/messageDetail",params:{message:{}},views:{"tab-message":{templateUrl:"build/pages/message/detail/messageDetail.html",controller:"messageDetailCtrl"}}}).state("tab.contact",{url:"/contact",views:{"tab-contact":{templateUrl:"build/pages/contact/contact.html",controller:"contactCtrl"}}}).state("tab.application",{url:"/application",views:{"tab-application":{templateUrl:"build/pages/application/application.html",controller:"applicationCtrl"}}}).state("tab.myInfo",{url:"/myInfo",views:{"tab-myInfo":{templateUrl:"build/pages/myInfo/myInfo.html",controller:"myInfoCtrl"}}}).state("guide",{url:"/guide",templateUrl:"build/pages/guide/guide.html",controller:"guideCtrl"}).state("login",{url:"/login",templateUrl:"build/pages/login/login.html",controller:"loginCtrl"}),window.localStorage.token&&""!=window.localStorage.token?t.otherwise("/tab/message"):t.otherwise("/login")}]),angular.module("applicationModule").controller("applicationCtrl",["$scope","$state","baseConfig",function(e,t,o){e.animationsEnabled=!1,e.officeApp=[{list:[{appName:"会议管理",imageUrl:"build/img/application/meetingManage@3x.png",destUrl:""},{appName:"个人申请",imageUrl:"build/img/application/meetingManage@3x.png",destUrl:""},{appName:"报表分析",imageUrl:"build/img/application/meetingManage@3x.png",destUrl:""},{appName:"人事政策",imageUrl:"build/img/application/meetingManage@3x.png",destUrl:""}]},{list:[{appName:"假期管理",imageUrl:"build/img/application/holidayManage@3x.png",destUrl:"tab.time-off-manage"},{appName:"住宿申请",imageUrl:"build/img/application/dorm-apply/dorm-apply.png",destUrl:"tab.dorm-apply"},{appName:"Timesheet填写",imageUrl:"build/img/application/timesheet@3x.png",destUrl:"tab.timesheet"},{appName:"Timesheet审批",imageUrl:"build/img/application/timesheetExamine@3x.png",destUrl:"tab.tsApproveList"}]}],e.projectApp=[{list:[{appName:"机票预定",imageUrl:"build/img/application/flightBooking@3x.png",destUrl:""},{appName:"代办事项",imageUrl:"build/img/application/flightBooking@3x.png",destUrl:"tab.workflow-list"},{appName:"报销单查询",imageUrl:"build/img/application/flightBooking@3x.png",destUrl:""},{appName:"首款查询",imageUrl:"build/img/application/flightBooking@3x.png",destUrl:""}]},{list:[{appName:"外勤汇报",imageUrl:"build/img/application/flightBooking@3x.png",destUrl:""},{appName:"",imageUrl:"",destUrl:""},{appName:"",imageUrl:"",destUrl:""},{appName:"",imageUrl:"",destUrl:""}]}],e.employeeApp=[{list:[{appName:"在线培训",imageUrl:"build/img/application/flightBooking@3x.png",destUrl:""},{appName:"知识门户",imageUrl:"build/img/application/flightBooking@3x.png",destUrl:""},{appName:"新闻",imageUrl:"build/img/application/flightBooking@3x.png",destUrl:""},{appName:"分享社区",imageUrl:"build/img/application/flightBooking@3x.png",destUrl:""}]}],e.openSetting=function(){e.animationsEnabled?e.animationsEnabled=!1:e.animationsEnabled=!0},e.goPage=function(e){o.debug&&console.log("appItem "+angular.toJson(e)),t.go(e.destUrl)},console.log("applicationCtrl.enter"),e.$on("$ionicView.enter",function(e){console.log("applicationCtrl.$ionicView.enter")}),e.$on("$destroy",function(e){console.log("applicationCtrl.$destroy")})}]),angular.module("contactModule").controller("contactCtrl",["$scope","$state",function(e,t){console.log("contactCtrl.enter"),e.$on("$ionicView.enter",function(e){console.log("contactCtrl.$ionicView.enter")}),e.$on("$destroy",function(e){console.log("contactCtrl.$destroy")})}]),angular.module("loginModule").controller("guideCtrl",["$scope","$state",function(e,t){console.log("loginCtrl.enter"),e.toLogin=function(){console.log("跳过导航页到登陆页"),t.go("login")},e.$on("$ionicView.enter",function(e){console.log("guideCtrl.$ionicView.enter")}),e.$on("$destroy",function(e){console.log("guideCtrl.$destroy")})}]),angular.module("messageModule").controller("messageCtrl",["$scope","$state","$timeout","$ionicPlatform",function(e,t,o,a){e.messageList=[],a.ready(function(){window.StatusBar&&StatusBar.styleLightContent()}),e.talk=function(e){console.log("$scope.talk"),t.go("tab.messageDetail",{message:e})},e.refresh=function(){o(function(){e.$broadcast("scroll.refreshComplete")},2e3)},console.log("messageCtrl.enter"),e.$on("$ionicView.enter",function(e){console.log("messageCtrl.$ionicView.enter")}),e.$on("$destroy",function(e){console.log("messageCtrl.$destroy")})}]),angular.module("loginModule").controller("loginCtrl",["$scope","$state","baseConfig","$ionicLoading","$http","$timeout","$ionicHistory","hmsPopup",function(e,t,o,a,n,r,s,l){e.loginData={},e.currentVersionNum=o.versionName,window.localStorage.empno&&(e.loginData.username=window.localStorage.empno),window.localStorage.checkboxSavePwd||(e.checkboxSavePwd=!0,window.localStorage.checkboxSavePwd="true"),"true"==window.localStorage.checkboxSavePwd?(e.checkboxSavePwd=!0,e.loginData.password=window.localStorage.password):e.checkboxSavePwd=!1,o.debug&&console.log("loginCtrl.enter"),e.savePassword=function(){e.checkboxSavePwd=!e.checkboxSavePwd,o.debug&&console.log("此时密码框的状态为 :",angular.toJson(e.checkboxSavePwd)),""!==e.loginData.password&&(e.checkboxSavePwd===!0?window.localStorage.password=e.loginData.password:window.localStorage.password="")},e.clearUser=function(){e.loginData.username=""},e.clearPassword=function(){e.loginData.password=""},e.doLogin=function(){if(window.localStorage.empno=e.loginData.username,e.checkboxSavePwd?window.localStorage.password=e.loginData.password:window.localStorage.password="",!e.loginData.username||""==e.loginData.username)return void l.showPopup("用户名不能为空");if(!e.loginData.password||""==e.loginData.password)return void l.showPopup("密码不能为空");var a=o.basePath+"/appLogin/user_login/login",r={params:{p_user_name:+e.loginData.username,p_password:e.loginData.password}};l.showLoading("登陆中..."),n.post(a,r).success(function(a){l.hideLoading(),o.debug&&console.log("result success "+angular.toJson(a)),a.status||"S"!=a.con_status?l.showPopup("登陆失败,可能是密码不对!"):(window.localStorage.token=a.pre_token+a.token_key,window.localStorage.empno=e.loginData.username,window.localStorage.checkboxSavePwd=e.checkboxSavePwd,t.go("tab.message"))}).error(function(e,t){l.hideLoading(),o.debug&&console.log("response error "+angular.toJson(e))})},e.$on("$ionicView.enter",function(e){o.debug&&console.log("loginCtrl.$ionicView.enter"),r(function(){s.clearCache(),s.clearHistory()},400)}),e.$on("$destroy",function(e){o.debug&&console.log("loginCtrl.$destroy")})}]),angular.module("myApp").config(["$stateProvider",function(e){e.state("tab.feedback",{url:"/feedback",views:{"tab-myInfo":{templateUrl:"build/pages/myInfo/feedback.html",controller:"FeedbackCtrl"}}})}]),angular.module("myInfoModule").controller("FeedbackCtrl",["$scope","baseConfig","$ionicHistory","hmsHttp","hmsPopup",function(e,t,o,a,n){e.qualityIssue=[!1,!1,!1,!1],e.feedbackInfo={info:""},e.selectQualityIssue=function(t){angular.forEach(e.qualityIssue,function(e,t,o){o[t]=!1}),e.qualityIssue[t]=!0},e.goBack=function(){o.goBack()},e.commit=function(){var t=0;angular.forEach(e.qualityIssue,function(e,o,a){0==a[o]&&t++}),t==e.qualityIssue.length?n.showShortCenterToast("请选择反馈问题类型"):""==e.feedbackInfo.info&&n.showShortCenterToast("请填写产品质量问题反馈")}}]),angular.module("myInfoModule").controller("myInfoCtrl",["$scope","$state","baseConfig",function(e,t,o){o.debug&&console.log("myInfoCtrl.enter"),e.logout=function(){window.localStorage.token="",window.localStorage.password="",window.localStorage.timesheetAuto="",window.localStorage.messagePush="",t.go("login")},e.setup=function(){t.go("tab.setup")},e.feedback=function(){t.go("tab.feedback")},e.checkMyInfo=function(){},e.$on("$ionicView.enter",function(e){o.debug&&console.log("myInfoCtrl.$ionicView.enter")}),e.$on("$destroy",function(e){o.debug&&console.log("myInfoCtrl.$destroy")})}]),angular.module("myApp").config(["$stateProvider",function(e){e.state("tab.setup",{url:"/setup",views:{"tab-myInfo":{templateUrl:"build/pages/myInfo/setup.html",controller:"SetupCtrl"}}})}]),angular.module("myInfoModule").controller("SetupCtrl",["$scope","baseConfig","$ionicHistory",function(e,t,o){window.localStorage.timesheetAuto||(e.timesheetAuto=!1,window.localStorage.timesheetAuto="false",t.debug&&console.log("timesheet自动填写功能默认关闭")),window.localStorage.messagePush||(e.messagePush=!1,window.localStorage.messagePush="false",t.debug&&console.log("消息推送功能默认关闭")),"true"==window.localStorage.timesheetAuto?(e.timesheetAuto=!0,t.debug&&console.log("打开timesheet自动填写功能")):(e.timesheetAuto=!1,t.debug&&console.log("关闭timesheet自动填写功能")),"true"==window.localStorage.messagePush?(e.messagePush=!0,t.debug&&console.log("打开消息推送功能")):(e.messagePush=!1,t.debug&&console.log("关闭消息推送功能")),e.clickTimesheetAuto=function(){e.timesheetAuto=!e.timesheetAuto,1==e.timesheetAuto?(window.localStorage.timesheetAuto="true",t.debug&&console.log("打开timesheet自动填写功能")):0==e.timesheetAuto&&(window.localStorage.timesheetAuto="false",t.debug&&console.log("关闭timesheet自动填写功能"))},e.clickMessagePush=function(){e.messagePush=!e.messagePush,1==e.messagePush?(window.localStorage.messagePush="true",t.debug&&console.log("打开消息推送功能")):0==e.messagePush&&(window.localStorage.messagePush="false",t.debug&&console.log("关闭消息推送功能"))},e.goBack=function(){o.goBack()}}]),angular.module("loginModule").controller("TabsCtrl",["$scope","$rootScope","$state","baseConfig",function(e,t,o,a){t.$on("$ionicView.beforeEnter",function(){var t=o.current.name;a.debug&&console.log("$ionicView.beforeEnter statename "+t),"tab.message"!=t&&"tab.application"!=t&&"tab.contact"!=t&&"tab.myInfo"!=t&&(e.hideTabs=!0)}),t.$on("$ionicView.afterEnter",function(){var t=o.current.name;a.debug&&console.log("$ionicView.afterEnter statename "+t),"tab.message"!==t&&"tab.application"!==t&&"tab.contact"!==t&&"tab.myInfo"!==t||(e.hideTabs=!1,e.$apply())})}]),angular.module("myApp").config(["$stateProvider",function(e){e.state("tab.dorm-apply-detail-a",{url:"/dorm-apply-detail-a",views:{"tab-application":{templateUrl:"build/pages/application/dorm-apply/dorm-apply-detail-a.html",controller:"DormApplyDetailFirstCtrl"}},params:{dormApplyDetailInfo:""}})}]),angular.module("applicationModule").controller("DormApplyDetailFirstCtrl",["$scope","$state","baseConfig","$ionicHistory","hmsHttp","hmsPopup","$rootScope","$timeout","$stateParams",function(e,t,o,a,n,r,s,l,i){e.applyInfo=i.dormApplyDetailInfo,e.approving=!1,e.rejected=!1,e.checkingin=!1,e.approvedResult="","审批中"==e.applyInfo.status?(e.approving=!0,e.rejected=!1,e.checkingin=!1,e.approvedResult=""):"已拒绝"==e.applyInfo.status?(e.approving=!1,e.rejected=!0,e.checkingin=!1,e.approvedResult="已拒绝"):"未入住"==e.applyInfo.status&&(e.approving=!1,e.rejected=!1,e.checkingin=!0,e.approvedResult="已通过"),e.goBack=function(){a.goBack()},e.cancelApply=function(){var t=o.businessPath+"/wfl_apply_room/cancel_application",l={params:{p_apply_id:e.applyInfo.applyId,p_employee_number:window.localStorage.empno}};r.showLoading("请稍候"),n.post(t,l).success(function(e){r.hideLoading();var t=e.message;r.showShortCenterToast(t),"S"==e.status&&(s.$broadcast("APPLY_CANCELLED"),a.goBack()),o.debug&&console.log("result success "+angular.toJson(e))}).error(function(e,t){r.hideLoading(),o.debug&&console.log("response error "+angular.toJson(e))})}}]),angular.module("myApp").config(["$stateProvider",function(e){e.state("tab.dorm-apply-detail-b",{url:"/dorm-apply-detail-b",
views:{"tab-application":{templateUrl:"build/pages/application/dorm-apply/dorm-apply-detail-b.html",controller:"DormApplyDetailSecondCtrl"}},params:{dormApplyDetailInfo:""}})}]),angular.module("applicationModule").controller("DormApplyDetailSecondCtrl",["$scope","$state","baseConfig","$ionicHistory","hmsHttp","hmsPopup","$rootScope","$timeout","$stateParams",function(e,t,o,a,n,r,s,l,i){e.applyInfo=i.dormApplyDetailInfo,e.checkIn=!1,e.checkOut=!1,e.buttonText="",e.leftDays=e.applyInfo.leftDays,e.totalDays=parseInt(e.applyInfo.checkinDays),"已入住"==e.applyInfo.status?(e.checkIn=!0,e.checkOut=!1,e.buttonText="续住"):"已退房"==e.applyInfo.status&&(e.checkIn=!1,e.checkOut=!0,e.buttonText="再次预定"),e.goBack=function(){a.goBack()},e.renewContract=function(){var t=o.businessPath+"/wfl_apply_room/overstay_apply_room",l={params:{p_employee_number:window.localStorage.empno,p_pro_id:"",p_checkin_date:"2016-08-15",p_checkout_date:"2016-09-20",p_room_number:e.applyInfo.roomNumber,p_bed_number:e.applyInfo.bedNumber,p_apply_type:e.applyInfo.applyType,p_reason:""}};"项目申请"==e.applyInfo.applyType&&(l.params.p_pro_id=e.applyInfo.projectId),r.showLoading("请稍候"),n.post(t,l).success(function(e){r.hideLoading();var t=e.message;r.showShortCenterToast(t),"S"==e.status&&(s.$broadcast("APPLY_SUCCESS"),a.goBack()),o.debug&&console.log("result success "+angular.toJson(e))}).error(function(e,t){r.hideLoading(),o.debug&&console.log("response error "+angular.toJson(e))})}}]),angular.module("myApp").config(["$stateProvider",function(e){e.state("tab.dorm-apply-vacant-room",{url:"/dorm-apply-vacant-room",views:{"tab-application":{templateUrl:"build/pages/application/dorm-apply/dorm-apply-vacant-room.html",controller:"DormApplyVacantRoomCtrl"}},params:{dormApplySearchResult:"",projectId:"",applyType:""}})}]),angular.module("applicationModule").controller("DormApplyVacantRoomCtrl",["$scope","$rootScope","$state","baseConfig","$ionicHistory","hmsHttp","hmsPopup","$timeout","$stateParams",function(e,t,o,a,n,r,s,l,i){var c=i.dormApplySearchResult,p=i.projectId,u=i.applyType;e.roomlist=c.result,e.goBack=function(){n.goBack()},e.applyRoom=function(o){var l=a.businessPath+"/wfl_apply_room/apply_room",i={params:{p_employee_number:window.localStorage.empno,p_pro_id:"",p_checkin_date:c.checkinDate,p_checkout_date:c.checkoutDate,p_room_number:e.roomlist[o].room_number,p_bed_number:e.roomlist[o].bed_number,p_apply_type:c.applyType,p_reason:""}};"项目申请"==u&&(i.params.p_pro_id=p),s.showLoading("请稍候"),r.post(l,i).success(function(e){s.hideLoading();var o=e.message;s.showShortCenterToast(o),"S"==e.status&&(n.goBack(-2),t.$broadcast("APPLY_SUCCESS")),a.debug&&console.log("result success "+angular.toJson(e))}).error(function(e,t){s.hideLoading(),a.debug&&console.log("response error "+angular.toJson(e))})}}]),angular.module("myApp").config(["$stateProvider",function(e){e.state("tab.dorm-apply",{url:"/dorm-apply",views:{"tab-application":{templateUrl:"build/pages/application/dorm-apply/dorm-apply.html",controller:"DormApplyCtrl"}}})}]),angular.module("applicationModule").controller("DormApplyCtrl",["$scope","$rootScope","$state","baseConfig","$ionicHistory","hmsHttp","hmsPopup","$ionicScrollDelegate","$timeout",function(e,t,o,a,n,r,s,l,i){function c(){e.items=[];var t=a.businessPath+"/wfl_apply_room/query_room_history_list",o={params:{p_employee_number:window.localStorage.empno}};r.post(t,o).success(function(t){a.debug&&console.log("result success "+angular.toJson(t)),e.items=t.result,angular.forEach(e.items,function(e,t,o){"已入住"==o[t].apply_status?(o[t].modeCheckIn=!0,o[t].modeCheckOut=!1,o[t].modeApproving=!1,o[t].modeRejected=!1,o[t].modeCheckingIn=!1):"已退房"==o[t].apply_status?(o[t].modeCheckIn=!1,o[t].modeCheckOut=!0,o[t].modeApproving=!1,o[t].modeRejected=!1,o[t].modeCheckingIn=!1):"审批中"==o[t].apply_status?(o[t].modeCheckIn=!1,o[t].modeCheckOut=!1,o[t].modeApproving=!0,o[t].modeRejected=!1,o[t].modeCheckingIn=!1):"已拒绝"==o[t].apply_status?(o[t].modeCheckIn=!1,o[t].modeCheckOut=!1,o[t].modeApproving=!1,o[t].modeRejected=!0,o[t].modeCheckingIn=!1):"未入住"==o[t].apply_status&&(o[t].modeCheckIn=!1,o[t].modeCheckOut=!1,o[t].modeApproving=!1,o[t].modeRejected=!1,o[t].modeCheckingIn=!0)})}).error(function(e,t){s.hideLoading(),a.debug&&console.log("response error "+angular.toJson(e))})}e.descriptionAppearance=!1,e.items=[],c(),e.goBack=function(){n.goBack()},e.createNewDormApply=function(){o.go("tab.new-dorm-apply")},e.viewApplyDetail=function(t){var a=e.items[t],n={status:a.apply_status,checkinDate:a.checkin_date,checkoutDate:a.checkout_date,applyType:a.apply_type,floorNumber:a.floor_number,roomNumber:a.room_number,roomType:a.room_type,bedNumber:a.bed_number,applyId:a.apply_id,projectId:a.project_id,checkinDays:a.checkin_days,leftDays:a.left_days};"已入住"==n.status||"已退房"==n.status?o.go("tab.dorm-apply-detail-b",{dormApplyDetailInfo:n}):"审批中"!=n.status&&"已拒绝"!=n.status&&"未入住"!=n.status||o.go("tab.dorm-apply-detail-a",{dormApplyDetailInfo:n})},e.judgeApplyType=function(e){var t=e.apply_status;return"已入住"==t||"已退房"==t||"未入住"==t?!0:"审批中"==t||"已拒绝"==t?!1:void 0},e.showDescription=function(){e.descriptionAppearance=!0},e.hideDescription=function(){e.descriptionAppearance=!1},t.$on("APPLY_SUCCESS",function(){i(function(){l.$getByHandle("dormScroll").scrollTop(!1)},200),c()}),t.$on("APPLY_CANCELLED",function(){i(function(){l.$getByHandle("dormScroll").scrollTop(!1)},200),c()})}]),angular.module("myApp").config(["$stateProvider",function(e){e.state("tab.new-dorm-apply",{url:"/new-dorm-apply",views:{"tab-application":{templateUrl:"build/pages/application/dorm-apply/new-dorm-apply.html",controller:"NewDormApplyCtrl"}}})}]),angular.module("applicationModule").controller("NewDormApplyCtrl",["$scope","$state","baseConfig","$ionicHistory","$ionicModal","hmsHttp","hmsPopup",function(e,t,o,a,n,r,s){n.fromTemplateUrl("build/pages/application/dorm-apply/modal/new-dorm-apply-choose-apply-type.html",{scope:e}).then(function(t){e.chooseTypePopup=t}),n.fromTemplateUrl("build/pages/application/dorm-apply/modal/new-dorm-apply-choose-room-type.html",{scope:e}).then(function(t){e.chooseRoomPopup=t}),n.fromTemplateUrl("build/pages/application/dorm-apply/modal/new-dorm-apply-choose-project-name.html",{scope:e}).then(function(t){e.chooseProjectPopup=t}),e.defaultApplyType="常驻申请",e.defaultRoomType="单人间",e.defaultProjectInfo={projectName:"",projectId:""},e.showProjectItem=!1,e.applytype=["常驻申请","加班申请","临时申请","项目申请"],e.roomtype=["单人间","四人间"],e.projectlist=[],e.showNumButton=!0,e.inputinfo={floornum:"",roomnum:""};var l=o.businessPath+"/wfl_apply_room/query_project_list",i={params:{p_employee_number:window.localStorage.empno}};s.showLoading("请稍候"),r.post(l,i).success(function(t){s.hideLoading(),"S"==t.status&&(e.projectlist=t.result,e.projectlist=e.projectlist.splice(1,e.projectlist.length-1),e.projectlist.length>0?(e.defaultProjectInfo.projectName=e.projectlist[0].project_name,e.defaultProjectInfo.projectId=e.projectlist[0].project_id,console.log(angular.toJson(e.defaultProjectInfo))):0==e.projectlist.length&&(e.defaultProjectInfo.projectName="无",e.defaultProjectInfo.projectId="")),o.debug&&console.log("result success "+angular.toJson(t))}).error(function(e){s.hideLoading(),o.debug&&console.log("response error "+angular.toJson(e))}),e.goBack=function(){a.goBack()},e.chooseApplyType=function(){e.chooseTypePopup.show()},e.chooseRoomType=function(){e.chooseRoomPopup.show()},e.chooseProjectName=function(){0==e.projectlist.length?s.showShortCenterToast("项目列表为空，请更改申请类型"):e.projectlist.length>0&&e.chooseProjectPopup.show()},e.finishChoosingApplyType=function(t){e.defaultApplyType=t,"项目申请"==e.defaultApplyType?e.showProjectItem=!0:"项目申请"!=e.defaultApplyType&&(e.showProjectItem=!1),e.chooseTypePopup.hide()},e.finishChoosingRoomType=function(t){e.defaultRoomType=t,e.chooseRoomPopup.hide()},e.finishChoosingProjectName=function(t){e.defaultProjectInfo.projectName=e.projectlist[t].project_name,e.defaultProjectInfo.projectId=e.projectlist[t].project_id,e.chooseProjectPopup.hide()},e.chooseDays=function(){"常驻申请"==e.defaultApplyType&&(e.showNumButton=!e.showNumButton)},e.searchVacantRoom=function(){if("无"==e.defaultProjectInfo.projectName&&"项目申请"==e.defaultApplyType)s.showShortCenterToast("项目列表为空，请更改申请类型");else{var a=o.businessPath+"/wfl_apply_room/query_free_room_list",n={params:{p_employee_number:window.localStorage.empno,p_check_in_date:"2016-06-22",p_check_out_date:"2016-08-20",p_apply_type:e.defaultApplyType,p_room_type:e.defaultRoomType,p_room_number:e.inputinfo.roomnum,p_floor_number:e.inputinfo.floornum,p_pro_id:""}};"项目申请"==e.defaultApplyType&&(n.params.p_pro_id=e.defaultProjectInfo.projectId),s.showLoading("请稍候"),r.post(a,n).success(function(a){var r=a.message;if(s.hideLoading(),"S"==a.status&&a.result.length>0){var l=a.result,i={applyType:n.params.p_apply_type,checkinDate:n.params.p_check_in_date,checkoutDate:n.params.p_check_out_date,result:l};t.go("tab.dorm-apply-vacant-room",{dormApplySearchResult:i,projectId:e.defaultProjectInfo.projectId,applyType:e.defaultApplyType})}else"E"==a.status&&s.showShortCenterToast(r);o.debug&&console.log("result success "+angular.toJson(a))}).error(function(e,t){s.hideLoading(),o.debug&&console.log("response error "+angular.toJson(e))})}}}]),angular.module("myApp").config(["$stateProvider",function(e){e.state("tab.time-off-manage",{url:"/time-off-manage",views:{"tab-application":{templateUrl:"build/pages/application/time-off-manage/timeOffManageList.html",controller:"TimeOffManageCtrl"}}})}]),angular.module("applicationModule").controller("TimeOffManageCtrl",["$scope","$state","baseConfig","$ionicHistory",function(e,t,o,a){e.paidHolidayLeftDays=20,e.paidHolidayTotalDays=90,e.paidSickLeftDays=50,e.paidSickTotalDays=90,e.extPaidHolidayLeftDays=45,e.extPaidHolidayTotalDays=90}]),angular.module("messageModule").controller("messageDetailCtrl",["$scope","$state","$stateParams","$ionicHistory",function(e,t,o,a){var n=o.message;console.log("message : "+angular.toJson(n)),e.message=n,e.goBack=function(){a.goBack()},e.$on("$ionicView.enter",function(e){console.log("messageDetailCtrl.$ionicView.enter")}),console.log("messageDetailCtrl.enter"),e.$on("$destroy",function(e){console.log("messageDetailCtrl.$destroy")})}]),angular.module("myApp").config(["$stateProvider",function(e){e.state("tab.workflow-list",{url:"/workflow-list",params:{day:{}},views:{"tab-application":{templateUrl:"build/pages/workflow/list/workflow-list.html",controller:"WorkFLowListCtrl"}}})}]),angular.module("applicationModule").controller("WorkFLowListCtrl",["$scope","$state","$stateParams","$ionicModal","$timeout","baseConfig","TimeSheetService","hmsPopup","WorkFLowListService",function(e,t,o,a,n,r,s,l,i){e.list=[],e.fetchDataFlag=!0,e.pullRefreshDataFlag=!1,e.listStatus={todo:{selected:!0},done:{selected:!1}};var c="build/img/application/profile@3x.png",p="工作流类型",u="当前节点",d="提交人";e.fetchTodoList=function(){e.listStatus.todo.selected||e.fetchDataFlag||e.pullRefreshDataFlag||(e.listStatus.todo.selected=!0,e.listStatus.done.selected=!1,g(!1))},e.fetchDoneList=function(){e.listStatus.done.selected||e.fetchDataFlag||e.pullRefreshDataFlag||(e.listStatus.done.selected=!0,e.listStatus.todo.selected=!1,m(!1))};var g=function(t){e.list=[],t?(e.fetchDataFlag=!1,e.pullRefreshDataFlag=!0):e.fetchDataFlag=!0;var o=function(o){var a=o.待审批列表;angular.forEach(a,function(t){var o={title1:t.workflow_name,icon:c,type:p,typeValue:t.workflow_name,node:u,nodeValue:t.current_node,submit:d,submitPerson:t.employee_name};e.list.push(o)}),e.fetchDataFlag=!1,t&&(e.pullRefreshDataFlag=!1,e.$broadcast("scroll.refreshComplete"))},a=function(o){e.fetchDataFlag=!1,t&&(e.pullRefreshDataFlag=!1,e.$broadcast("scroll.refreshComplete"))};n(function(){i.getTodoList("N",o,a)},2e3)},m=function(t){e.list=[],t?(e.fetchDataFlag=!1,e.pullRefreshDataFlag=!0):e.fetchDataFlag=!0;var o=function(o){var a=o.已审批列表;angular.forEach(a,function(t){var o={title1:t.workflow_desc,icon:c,type:p,typeValue:t.workflow_desc,node:u,nodeValue:t.status_name,submit:d,submitPerson:t.created_by_name};e.list.push(o)}),e.fetchDataFlag=!1,t&&(e.pullRefreshDataFlag=!1,e.$broadcast("scroll.refreshComplete"))},a=function(o){e.fetchDataFlag=!1,t&&(e.pullRefreshDataFlag=!1,e.$broadcast("scroll.refreshComplete"))};n(function(){i.getTodoList("Y",o,a)},2e3)};g(!1),a.fromTemplateUrl("build/pages/application/timesheet-approve/modal/ts-filter-modal.html",{scope:e}).then(function(t){e.tsFilterModal=t}),e.filterTsInfo=function(){e.tsFilterModal.show()},e.refresh=function(){e.fetchDataFlag?e.$broadcast("scroll.refreshComplete"):(e.list=[],e.$apply(),n(function(){e.listStatus.todo.selected?g(!0):m(!0)},300))}}]).service("WorkFLowListService",["hmsHttp","baseConfig","hmsPopup",function(e,t,o){this.getTodoList=function(a,n,r){var s=t.businessPath+"/wfl_wx_workflow_appr/get_instance_list",l={params:{p_employee_code:window.localStorage.empno,p_flag:a+""}};e.post(s,l).success(function(e){n(e)}).error(function(e,t){o.showPopup("获取代办事项出错,可能是网络问题!"),r(e)})}}]),angular.module("myApp").config(["$stateProvider",function(e){e.state("tab.tsApproveDetail",{url:"application/tsApproveDetail",views:{"tab-application":{templateUrl:"build/pages/application/timesheet-approve/detail/ts-approve-detail.html",controller:"tsApproveDetailCtrl"}},params:{employeeNumber:"",projectId:"",startDate:"",endDate:""}})}]),tsApproveModule.controller("tsApproveDetailCtrl",["$scope","$state","baseConfig","$ionicHistory","$stateParams","hmsHttp","hmsPopup","$timeout",function(e,t,o,a,n,r,s,l){function i(){r.post(g,m).success(function(t){s.hideLoading(),r.isSuccessfull(t.status)?e.detailInfoArray=t.timesheet_approve_detail_response:"E"===t.status||"e"==t.status?s.showShortCenterToast("没有相关数据!"):s.showShortCenterToast("网络异常,请稍后重试!")}).error(function(e,t){s.hideLoading(),s.showShortCenterToast("服务请求异常,请检查网络连接和输入参数后重新操作!")})}function c(t){e.selectArray=[],u=[],angular.forEach(e.detailInfoArray,function(o,a){"undoSelectAll"==t?(e.selectArray.push(!1),u.push(!1)):"selectedAll"==t&&(e.selectArray.push(!0),u.push(!0))})}function p(){for(var e=0;e<y.approve_list.length;e++)"delete"===y.approve_list[e]&&(y.approve_list.splice(e,1),e--)}var u=[],d=!1;e.detailActionName="操作",e.showActionBar=!1,e.detailInfoArray={},e.selectArray=[];var g=o.businessPath+"/wfl_timesheet_view/query_timesheet_approve_list",m={params:{p_employee_number:n.employeeNumber,p_start_date:n.startDate.toString(),p_end_date:n.endDate.toString(),p_project_id:n.projectId}},f=o.businessPath+"/wfl_timesheet_view/timesheet_approve",h={params:{p_approve_flag:"AGREE",p_employee_number:window.localStorage.empno,p_param_json:""}},y={approve_list:[]};s.showLoading("加载中..."),i(),e.$on("$ionicView.enter",function(e){warn("tsApproveListCtrl.$ionicView.enter")}),e.$on("$destroy",function(e){warn("tsApproveListCtrl.$destroy")}),c("undoSelectAll"),e.dealDetailInfo=function(){"操作"==e.detailActionName?(e.detailActionName="取消",e.showActionBar=!0,angular.element("#tsApproveItem").css("paddingLeft","6%")):"取消"==e.detailActionName&&(e.detailActionName="操作",e.showActionBar=!1,c("undoSelectAll"),angular.element("#tsApproveItem").css("paddingLeft","0"),h={params:{p_approve_flag:"AGREE",p_employee_number:window.localStorage.empno,p_param_json:""}},y={approve_list:[]})},e.selectItem=function(t,o){u[t]=!u[t];var a={p_project_id:e.detailInfoArray.project_id,p_project_person_number:e.detailInfoArray.employee_number,p_start_date:"",p_end_date:"",p_record_id:""};u[t]?(e.selectArray[t]=!0,a.p_record_id=o,y.approve_list[t]=a):(e.selectArray[t]=!1,y.approve_list.splice(t,1,"delete"))},e.selectAllDetail=function(){if(d=!d){c("selectedAll");for(var t=0;t<e.detailInfoArray.subsidy_list.length;t++){var o={p_project_id:e.detailInfoArray.project_id,p_project_person_number:e.detailInfoArray.employee_number,p_start_date:"",p_end_date:"",p_record_id:""};o.p_record_id=e.listInfoArray.subsidy_list[t].line_number,y.approve_list.push(o)}}else c("undoSelectAll"),y.approve_list=[]},e.passThroughDetailItem=function(){return 0===y.approve_list.length?void s.showShortCenterToast("请先选择操作项！"):(p(),h.params.p_approve_flag="AGREE",h.params.p_param_json=JSON.stringify(y),s.showLoading("审批中..."),void r.post(f,h).success(function(t){s.hideLoading(),r.isSuccessfull(t.status)?s.showShortCenterToast("审批成功！"):s.showShortCenterToast("审批失败！"),e.dealDetailInfo(),l(function(){s.showLoading("加载中..."),i()},1500)}).error(function(t){s.hideLoading(),s.showShortCenterToast("审批失败！请检查网络稍后重试"),e.dealDetailInfo(),l(function(){s.showLoading("加载中..."),i()},1500)}))},e.refuseDetailItem=function(){return 0===y.approve_list.length?void s.showShortCenterToast("请先选择操作项！"):(p(),h.params.p_approve_flag="REFUSE",h.params.p_param_json=JSON.stringify(y),s.showLoading("审批中..."),void r.post(f,h).success(function(t){s.hideLoading(),r.isSuccessfull(t.status)?s.showShortCenterToast("操作成功！"):s.showShortCenterToast("拒绝失败！"),e.dealDetailInfo(),l(function(){s.showLoading("加载中..."),i()},1500)}).error(function(t){s.hideLoading(),s.showShortCenterToast("拒绝失败！请检查网络稍后重试"),e.dealDetailInfo(),l(function(){s.showLoading("加载中..."),i()},1500)}))}}]),angular.module("myApp").config(["$stateProvider",function(e){e.state("tab.tsApproveList",{url:"application/tsApproveList",views:{"tab-application":{templateUrl:"build/pages/application/timesheet-approve/list/ts-approve-list.html",controller:"tsApproveListCtrl"}}})}]),angular.module("tsApproveModule").controller("tsApproveListCtrl",["$scope","$state","baseConfig","$ionicModal","$ionicScrollDelegate","$ionicPopup","$timeout","TsApproveListService","hmsPopup","hmsHttp",function(e,t,o,a,n,r,s,l,i,c){function p(){e.showLsLoading=!0,c.post(b,v).success(function(t){c.isSuccessfull(t.status)&&(e.personList=unique_better(t.project_person_list,"employee_number"),e.projectList=unique_better(t.project_list,"project_id"))}).error(function(e){}),e.listInfoArray=new l(e,y,v,e.showLsLoading)}function u(t){e.selectArray=[],h=[],angular.forEach(e.listInfoArray,function(o,a){"undoSelectAll"==t?(e.selectArray.push(!1),h.push(!1)):"selectedAll"==t&&(e.selectArray.push(!0),h.push(!0))})}function d(){for(var e=0;e<k.approve_list.length;e++)"delete"===k.approve_list[e]&&(k.approve_list.splice(e,1),e--)}function g(){e.tsFilterModal.hide(),e.showProjectName=!0,e.isClickedProject=[],e.isClickedPerson=[],angular.element("#project-name").addClass("active-select"),angular.element("#project-name").removeClass("active-off"),angular.element("#person-select").removeClass("active-select")}e.showProjectName=!0,e.showRocket=!1,e.showConnectBlock=!1,e.showDetailArrow=!0,e.showLsLoading=!1;var m=!1;e.endApproveDate="",e.actionName="操作",e.selectArray=[],e.isClickedProject=[],e.selectEndItem=[!1,!0,!1],e.listInfoArray={},e.personList=[],e.projectList=[],e.endDateList=[{dateValue:getMonthDay(getLastMonthDate(new Date)).replace(/\b(0+)/gi,""),dateCode:getLastMonthDate(new Date)},{dateValue:getMonthDay(getCurrentDate(new Date)).replace(/\b(0+)/gi,""),dateCode:getCurrentDate(new Date)},{dateValue:getMonthDay(getCurrentMonthLastDate(new Date)).replace(/\b(0+)/gi,""),dateCode:getCurrentMonthLastDate(new Date)}];var f="",h=[],y=o.businessPath+"/wfl_timesheet_view/get_timesheet_list",b=o.businessPath+"/wfl_timesheet_view/get_project_person_list",w=o.businessPath+"/wfl_timesheet_view/timesheet_approve",v={params:{p_employee_number:window.localStorage.empno,p_start_date:"",p_end_date:"",p_project_name:"",p_project_id:"",p_project_person_number:"",p_page:1,p_page_size:6}},_={params:{p_approve_flag:"AGREE",p_employee_number:window.localStorage.empno,p_param_json:""}},k={approve_list:[]},S=(new Date).getDate();10>S?(v.params.p_end_date=getLastMonthDate(new Date),e.endApproveDate=getMonthDay(getLastMonthDate(new Date)).replace(/\b(0+)/gi,"")):S>10&&20>S?(v.params.p_end_date=getCurrentDate(new Date),e.endApproveDate=getMonthDay(getCurrentDate(new Date)).replace(/\b(0+)/gi,"")):S>20&&(v.params.p_end_date=getCurrentMonthLastDate(new Date),e.endApproveDate=getMonthDay(getCurrentMonthLastDate(new Date)).replace(/\b(0+)/gi,"")),p(),e.$on("$ionicView.enter",function(e){}),e.$on("$destroy",function(e){log("tsApproveListCtrl.$destroy")}),u("undoSelectAll"),e.doSelectAction=function(){"操作"==e.actionName?(e.actionName="取消",e.showDetailArrow=!1,angular.element(".ts-approve-list-item").css("paddingLeft","10%")):"取消"==e.actionName&&(e.actionName="操作",e.showDetailArrow=!0,angular.element(".ts-approve-list-item").css("paddingLeft","10px"),_={params:{p_approve_flag:"AGREE",p_employee_number:window.localStorage.empno,p_param_json:""}},k={approve_list:[]},u("undoSelectAll"))},a.fromTemplateUrl("build/pages/application/timesheet-approve/modal/ts-date-modal.html",{scope:e}).then(function(t){e.dateModal=t}),e.selectEndDate=function(){v.params.p_end_date=e.endApproveDate,e.dateModal.show()},e.selectEndDateItem=function(t,o,a){e.selectEndItem=[],e.selectEndItem[a]=!0,e.endApproveDate=o,v.params.p_page=1,v.params.p_end_date=t,e.listInfoArray=new l(e,y,v,e.showLsLoading),e.dateModal.hide()},e.cancelDateModal=function(){v.params.p_end_date=e.endApproveDate,e.dateModal.hide()},e.onDrag=function(){e.showConnectBlock=!1},e.onDragUp=function(){e.showConnectBlock=!0},e.watchScroll=function(){f=n.getScrollPosition().top,e.$apply(function(){0>f?e.showConnectBlock=!1:f>=0&&400>f?(e.showRocket=!1,e.showConnectBlock=!0):f>=400&&(e.showRocket=!0)})},e.tsListRefresh=function(){v.params.p_page=1,e.listInfoArray=new l(e,y,v,e.showLsLoading)},e.getAttentionInfo=function(t,o){e.showDetailArrow&&(t.stopPropagation(),warn(o),r.show({template:'<div class="warn-attention-icon">'+o[0].description+"</div>",scope:e,buttons:[{text:'<div class="warn-cancel-icon"></div>',type:"button-clear",onTap:function(e){}}]}))},e.goTsLsTop=function(){angular.element("#rocket").addClass("ng-hide"),n.scrollTop(!0)},a.fromTemplateUrl("build/pages/application/timesheet-approve/modal/ts-filter-modal.html",{scope:e}).then(function(t){e.tsFilterModal=t}),e.filterTsInfo=function(){v.params.p_project_id="",v.params.p_project_person_number="",e.tsFilterModal.show()},e.goApproveDetail=function(o,a,n,r,s){if(e.showDetailArrow)t.go("tab.tsApproveDetail",{employeeNumber:a,projectId:n,startDate:r,endDate:s});else{h[o]=!h[o];var l={p_project_id:"",p_project_person_number:"",p_start_date:"",p_end_date:"",p_record_id:""};h[o]?(e.selectArray[o]=!0,l.p_project_id=n,l.p_project_person_number=a,l.p_start_date=r,l.p_end_date=s,k.approve_list[o]=l):(k.approve_list.splice(o,1,"delete"),e.selectArray[o]=!1)}},e.selectAllList=function(){if(m=!m){for(var t=0;t<e.listInfoArray.listArray.length;t++){var o={p_project_id:"",p_project_person_number:"",p_start_date:"",p_end_date:"",p_record_id:""};o.p_project_id=e.listInfoArray.listArray[t].project_id,o.p_project_person_number=e.listInfoArray[t].employee_number,o.p_start_date=e.listInfoArray[t].start_date,o.p_end_date=e.listInfoArray[t].end_date,k.approve_list.push(o)}u("selectedAll")}else k.approve_list=[],u("undoSelectAll")},e.passThroughListItem=function(){return 0===k.approve_list.length?void i.showShortCenterToast("请先选择操作项！"):(d(),_.params.p_approve_flag="AGREE",_.params.p_param_json=JSON.stringify(k),i.showLoading("审批中..."),void c.post(w,_).success(function(t){i.hideLoading(),c.isSuccessfull(t.status)?i.showShortCenterToast("审批成功！"):i.showShortCenterToast("审批失败！"),e.doSelectAction(),s(function(){e.tsListRefresh()},1500)}).error(function(t){i.hideLoading(),i.showShortCenterToast("审批失败！请检查网络稍后重试"),e.doSelectAction(),s(function(){e.tsListRefresh()},1500)}))},e.refuseListItem=function(){return 0===k.approve_list.length?void i.showShortCenterToast("请先选择操作项！"):(d(),_.params.p_approve_flag="REFUSE",_.params.p_param_json=JSON.stringify(k),i.showLoading("审批中..."),void c.post(w,_).success(function(t){i.hideLoading(),c.isSuccessfull(t.status)?i.showShortCenterToast("拒绝成功！"):i.showShortCenterToast("拒绝失败！"),e.doSelectAction(),s(function(){e.tsListRefresh()},1500)}).error(function(t){i.hideLoading(),i.showShortCenterToast("拒绝失败！请检查网络稍后重试"),e.doSelectAction(),s(function(){e.tsListRefresh()},1500)}))},e.selectScreening=function(t){"projectName"==t?(e.showProjectName=!0,angular.element("#project-name").addClass("active-select"),angular.element("#project-name").removeClass("active-off"),angular.element("#person-select").removeClass("active-select")):"personSelect"==t&&(e.showProjectName=!1,angular.element("#person-select").addClass("active-select"),angular.element("#project-name").addClass("active-off"))},e.selectFilterItem=function(t,o,a){"projectName"===t?(e.isClickedProject=[],e.isClickedProject[o]=!0,v.params.p_project_id=a):"personSelect"===t&&(e.isClickedPerson=[],e.isClickedPerson[o]=!0,v.params.p_project_person_number=a)},e.cancelFilter=function(){v.params.p_project_id="",v.params.p_project_person_number="",g()},e.confirmFilter=function(){g(),v.params.p_page=1,e.showLsLoading=!0,e.listInfoArray=new l(e,y,v,e.showLsLoading)},e.clearFilterParams=function(){e.isClickedProject=[],e.isClickedPerson=[],v.params.p_project_id="",v.params.p_project_person_number=""}}]).service("TsApproveListService",["hmsHttp","baseConfig","hmsPopup",function(e,t,o){var a=function(a,n,r,s,l){var i=this;i.scope=a,i.url=n,i.params={},i.params=r,i.refurbishParam=l,i.busy=!1,i.totalNumber=0,i.listArray=[],i.loading=s,"clickRefreshEvent"===i.refurbishParam&&i.scope.$broadcast("scroll.infiniteScrollComplete"),e.post(i.url,i.params).success(function(a){i.loading=!1;try{if(e.isSuccessfull(a.status)){var n=a.timesheet_approve_response;t.debug&&warn("hi,create a new factory!!\n"+jsonFormat()),i.totalNumber=a.count;try{i.listArray=i.listArray.concat(n.result_list)}catch(r){i.listArray=[],i.projectList=[],i.employeeList=[]}0==a.count?(i.busy=!1,i.listArray=[]):a.count<=6?i.busy=!1:i.busy=!0,i.scope.$broadcast("scroll.refreshComplete"),i.scope.$broadcast("scroll.infiniteScrollComplete")}else i.busy=!1,"E"===a.status||"e"==a.status?o.showShortCenterToast("没有相关数据!"):o.showShortCenterToast("网络异常,请稍后重试!"),i.scope.$broadcast("scroll.refreshComplete"),i.scope.$broadcast("scroll.infiniteScrollComplete")}catch(r){}}.bind(i)).error(function(e){i.loading=!1,i.params.params.p_page=1,i.busy=!1,i.scope.$broadcast("scroll.refreshComplete"),i.scope.$broadcast("scroll.infiniteScrollComplete"),o.showShortCenterToast("服务请求异常,请检查网络连接和输入参数后重新操作!")}.bind(i))};return a.prototype.nextPage=function(){var a=this;if(t.debug&&warn("enter next page!"),a.busy){if(a.busy&&"clickRefreshEvent"===a.refurbishParam)return a.refurbishParam="",void a.scope.$broadcast("scroll.infiniteScrollComplete");a.busy=!0,a.params.params.p_page++,e.post(a.url,a.params).success(function(t){try{if(e.isSuccessfull(t.status)){if(angular.isUndefined(t.timesheet_approve_response.result_list))a.busy=!1,o.showShortCenterToast("数据已经加载完毕!");else{var n=t.timesheet_approve_response;a.listArray=a.listArray.concat(n.result_list)}a.scope.$broadcast("scroll.infiniteScrollComplete")}else"E"===t.status&&(a.params.params.p_page--,o.showShortCenterToast("数据请求错误,请检查传入参数重新操作!")),a.scope.$broadcast("scroll.infiniteScrollComplete")}catch(r){a.params.params.p_page--,a.scope.$broadcast("scroll.infiniteScrollComplete")}}.bind(a)).error(function(e){a.params.params.p_page--,a.scope.$broadcast("scroll.infiniteScrollComplete"),o.showShortCenterToast("网络异常,请稍后重试!")}.bind(a))}},a}]),angular.module("myApp").config(["$stateProvider",function(e){e.state("tab.timesheet",{url:"/timesheet",views:{"tab-application":{templateUrl:"build/pages/application/timesheet/query/query.html",controller:"TimeSheetQueryCtrl"}}})}]),angular.module("applicationModule").controller("TimeSheetQueryCtrl",["$scope","$state","baseConfig","$ionicHistory","$timeout","$ionicScrollDelegate","TimeSheetService","hmsHttp",function(e,t,o,a,n,r,s,l){e.calendar=[];var c=!0;e.loadingDataFlag=!0;var p=function(){for(e.calendar=[],i=0;i<5;i++){var t="each-day",o="day-item",a="",n="",r={week:i,list:[]};for(j=0;j<7;j++){var s={day:i+""+j,style_outline:t,style_color:o,money:a,project:n};r.list.push(s)}e.calendar.push(r)}};test=function(){var e=o.businessPath+"/wfl_timesheet_view/get_timesheet_list",t={params:{p_employee_number:"4040",p_start_date:"2015-11-01",p_end_date:"2015-11-01",p_project_name:"",p_project_id:"",p_project_person_number:"",p_page:"1",p_line_number:"5"}};l.post(e,t).success(function(e){o.debug&&console.log("result success "+angular.toJson(e))}).error(function(e,t){o.debug&&console.log("response error "+angular.toJson(e))})},test(),p(),e.writeTimesheet=function(e){t.go("tab.timesheet-write",{day:e})},e.scrollToFixScreen=function(){c?(r.scrollTo(0,400,!0),c=!1):(r.scrollTo(0,0,!0),c=!0)};var u=function(t){var o=t.timesheet,a=0;for(e.calendar=[],i=0;i<5;i++){var n={week:i,list:[]};for(j=0;j<7;j++){var r,s="each-day",l="day-item",c="",p="",u=!1;o[a]?(u="0"!=o[a].lockflag,"Empty"==o[a].status?(s="each-day",l="day-item"):"Draft"==o[a].status?(s="each-day attendance",l="day-item attendance"):"Approved"==o[a].status?(s="each-day approve",l="day-item approve"):"Rejected"==o[a].status&&(s="each-day reject",l="day-item reject"),r={day:o[a].day.replace("0",""),style_outline:s,style_color:l,money:o[a].allowance,project:o[a].proj,each_day:o[a].each_day,lockFlag:u}):r={day:"",style_outline:s,style_color:l,money:c,project:p,each_day:"",lockFlag:u},n.list.push(r),a+=1}e.calendar.push(n)}},d=function(t){p(),e.loadingDataFlag=!0;var a=o.businessPath+"/timesheet_process/fetch_calendar",n={params:{p_employee:window.localStorage.empno,p_month:t+"",p_offset:1}};l.post(a,n).success(function(t){u(t),e.loadingDataFlag=!1,o.debug&&console.log("result success "+angular.toJson(t))}).error(function(t,a){e.loadingDataFlag=!1,e.$apply(),o.debug&&console.log("response error "+angular.toJson(t))})};d("201511"),e.getTimeSheet=function(e){d(e)},e.goBack=function(){a.$ionicGoBack()},o.debug&&console.log("applicationCtrl.enter"),e.$on("$ionicView.enter",function(e){o.debug&&console.log("applicationCtrl.$ionicView.enter")}),e.$on("$destroy",function(e){o.debug&&console.log("applicationCtrl.$destroy")})}]).service("TimeSheetService",["baseConfig","hmsHttp","hmsPopup",function(e,t,o){this.fetchCalendar=function(){var o=e.businessPath+"/timesheet_process/fetch_calendar",a={params:{p_employee:window.localStorage.empno,p_month:"201511",p_offset:1}};t.post(o,a).success(function(t){e.debug&&console.log("result success "+angular.toJson(t))}).error(function(t,o){e.debug&&console.log("response error "+angular.toJson(t))})},this.fetchEachDay=function(a){var n=e.businessPath+"/timesheet_process/fetch_projects",r={params:{p_employee:window.localStorage.empno+"",p_date:"20151013"}};t.post(n,r).success(function(e){a(e)}).error(function(e,t){o.hideLoading(),o.showPopup("获取状态错误,请检查")})}}]),angular.module("myApp").config(["$stateProvider",function(e){e.state("tab.timesheet-write",{url:"/timesheet-write",params:{day:{}},views:{"tab-application":{templateUrl:"build/pages/application/timesheet/write/write.html",controller:"TimeSheetWriteCtrl"}}})}]),angular.module("applicationModule").controller("TimeSheetWriteCtrl",["$scope","$state","$stateParams","$ionicModal","$timeout","baseConfig","TimeSheetService","hmsPopup",function(e,t,o,a,n,r,s,l){var i="ion-ios-checkmark",c="ion-ios-circle-outline";e.projectList=[],e.addressList=[],e.flybackList=[],e.timesheetDetail={currentDay:"",approver:"",currentProject:{},currentAddress:{},currentFlyback:{},travelingAllowance:{flag:!1,style:c},normalAllowance:{flag:!1,style:c},charging:{flag:!1,style:c},description:""},r.debug&&console.log("$stateParams.day "+angular.toJson(o.day)),a.fromTemplateUrl("build/pages/application/timesheet/write/modal/projectModal.html",{scope:e}).then(function(t){e.projectModal=t}),a.fromTemplateUrl("build/pages/application/timesheet/write/modal/addressModal.html",{scope:e}).then(function(t){e.addressModal=t}),a.fromTemplateUrl("build/pages/application/timesheet/write/modal/flybackList.html",{scope:e}).then(function(t){e.flybackModal=t}),e.showProjectModal=function(){e.projectModal.show()},e.hideProjectModal=function(){e.projectModal.hide()},e.showFlybackModal=function(){e.flybackModal.show();
},e.hideFlybackModal=function(){e.flybackModal.hide()},e.showAddressModal=function(){e.addressModal.show()},e.hideAddressModal=function(){e.addressModal.hide()};var p=function(t){if(l.hideLoading(),"S"==t.status){var o=t.project,a=t.flyback,n=t.projaddress;"1"===t.every_day.offbase?e.timesheetDetail.travelingAllowance={flag:!0,style:i}:e.timesheetDetail.travelingAllowance={flag:!1,style:c},"Y"===t.every_day.base?e.timesheetDetail.normalAllowance={flag:!0,style:i}:e.timesheetDetail.normalAllowance={flag:!1,style:c},"1"===t.every_day.externalcharge?e.timesheetDetail.charging={flag:!0,style:i}:e.timesheetDetail.charging={flag:!1,style:c},e.timesheetDetail.currentDay=t.every_day.every_day,e.timesheetDetail.approver=t.every_day.approver,e.timesheetDetail.description=t.every_day.descrpt,e.timesheetDetail.allowance=t.every_day.allowance,angular.forEach(o,function(t){return"Y"===t.selected_flag?void(e.timesheetDetail.currentProject=t):void 0}),angular.forEach(n,function(t){return"Y"===t.selected_flag?void(e.timesheetDetail.currentAddress=t):void 0}),angular.forEach(a,function(t){return"Y"===t.fly_select?void(e.timesheetDetail.currentFlyback=t):void 0}),e.projectList=o,e.addressList=n,e.flybackList=a}};e.checkBoxChanged=function(t,o){console.log("$scope.checkBoxChanged item "+angular.toJson(t)),t.flag?(t.flag=!1,t.style=c):(t.flag=!0,t.style=i),"travelingAllowance"==o&&e.timesheetDetail.travelingAllowance.flag&&(e.timesheetDetail.normalAllowance={flag:!1,style:c}),"normalAllowance"==o&&e.timesheetDetail.normalAllowance.flag&&(e.timesheetDetail.travelingAllowance={flag:!1,style:c})},e.submitTimesheet=function(e){r.debug&&console.log("timesheetDetail "+angular.toJson(e))},n(function(){l.showLoading("获取timesheet明细数据"),s.fetchEachDay(p)})}]);